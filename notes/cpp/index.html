<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" class="next-head"/><meta property="og:title" class="next-head"/><meta property="og:description" content="Yao Ming, a Ph.D. student in computer science and engineering at HKUST. My research interests are explainable and interpretable machine learning (or some called XAI), data visualization and visual analytics." class="next-head"/><meta property="og:type" content="website" class="next-head"/><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous" class="next-head"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous" class="next-head"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous" class="next-head"></script><link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i|Open+Sans" rel="stylesheet" class="next-head"/><style type="text/css" class="next-head">
        body {
          font-family: &#x27;Lato&#x27;, &#x27;Open Sans&#x27;, &#x27;Noto Sans SC&#x27;, &quot;Microsoft YaHei&quot;, sans-serif;
        }
      </style><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-90189261-1" class="next-head"></script><script class="next-head">window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag("js", new Date());

        gtag("config", "UA-90189261-1");</script><title class="next-head">Yao Ming - Key Concepts of C++</title><meta charSet="utf-8" class="next-head"/><meta name="description" content="" class="next-head"/><meta property="og:title" content="Key Concepts of C++" class="next-head"/><meta property="og:description" content="" class="next-head"/><meta property="og:type" content="website" class="next-head"/><meta name="twitter:card" content="summary" class="next-head"/><meta name="twitter:creator" content="Yao Ming" class="next-head"/><meta name="twitter:title" content="Key Concepts of C++" class="next-head"/><meta name="twitter:description" content="" class="next-head"/><script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous" class="next-head"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous" class="next-head"></script><script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous" class="next-head"></script><link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i,700,700i|Open+Sans" rel="stylesheet" class="next-head"/><style type="text/css" class="next-head">
        body {
          font-family: &#x27;Lato&#x27;, &#x27;Open Sans&#x27;, &#x27;Noto Sans SC&#x27;, &quot;Microsoft YaHei&quot;, sans-serif;
        }
      </style><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-90189261-1" class="next-head"></script><script class="next-head">window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag("js", new Date());

        gtag("config", "UA-90189261-1");</script><link rel="preload" href="/_next/static/zrRi-1ffeFEQNXR69U2LU/pages/_page.js" as="script"/><link rel="preload" href="/_next/static/zrRi-1ffeFEQNXR69U2LU/pages/_app.js" as="script"/><link rel="preload" href="/_next/static/runtime/webpack-8ed9452df514b4d17d80.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.e955fcbc742f6dbffcf8.js" as="script"/><link rel="preload" href="/_next/static/chunks/styles.a36c8329d462c9b58534.js" as="script"/><link rel="preload" href="/_next/static/runtime/main-fd73dbd6f398b7b886ec.js" as="script"/><link rel="stylesheet" href="/_next/static/css/commons.b743098e.chunk.css"/><link rel="stylesheet" href="/_next/static/css/styles.f66215a5.chunk.css"/><style id="__jsx-3606128814">.loader.jsx-3606128814{width:100%;height:100%;position:absolute;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;background:#ffffff;z-index:1700;}.loader.jsx-3606128814 svg.jsx-3606128814{width:20%;height:20%;display:block;margin:auto;}.loader-show.jsx-3606128814{visibility:visible;-webkit-transition:opacity 300ms 300ms,visibility 0s 0s;transition:opacity 300ms 300ms,visibility 0s 0s;opacity:1;}.loader-hide.jsx-3606128814{visibility:hidden;-webkit-transition:opacity 300ms 300ms,visibility 0s 600ms;transition:opacity 300ms 300ms,visibility 0s 600ms;opacity:0;}</style></head><body><div id="__next"><div class="jsx-3606128814 loader loader-show"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" class="jsx-3606128814"><circle transform="translate(8 0)" cx="0" cy="16" r="0" class="jsx-3606128814"><animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0" keyTimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" class="jsx-3606128814"></animate></circle><circle transform="translate(16 0)" cx="0" cy="16" r="0" class="jsx-3606128814"><animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.3" keyTimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" class="jsx-3606128814"></animate></circle><circle transform="translate(24 0)" cx="0" cy="16" r="0" class="jsx-3606128814"><animate attributeName="r" values="0; 4; 0; 0" dur="1.2s" repeatCount="indefinite" begin="0.6" keyTimes="0;0.2;0.7;1" keySplines="0.2 0.2 0.4 0.8;0.2 0.6 0.4 0.8;0.2 0.6 0.4 0.8" calcMode="spline" class="jsx-3606128814"></animate></circle></svg></div><div style="display:none"><div><header id="m-header" class="fixed-top"><div class="m-header-container"><nav class="navbar navbar-expand-md navbar-light m-navbar"><span class="navbar-brand" href="#">Yao Ming <span style="font-size:14px">(明遥)</span></span><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto"><li class="nav-item"><a class="nav-link" data-nav-identifier="home" href="/"><i><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" class="svg-inline--fa fa-home fa-w-18 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" style="margin-right:5px"><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg></i>Home</a></li><li class="nav-item"><a class="nav-link" data-nav-identifier="about" href="/#about"><i><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="user-circle" class="svg-inline--fa fa-user-circle fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" style="margin-right:5px"><path fill="currentColor" d="M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 96c48.6 0 88 39.4 88 88s-39.4 88-88 88-88-39.4-88-88 39.4-88 88-88zm0 344c-58.7 0-111.3-26.6-146.5-68.2 18.8-35.4 55.6-59.8 98.5-59.8 2.4 0 4.8.4 7.1 1.1 13 4.2 26.6 6.9 40.9 6.9 14.3 0 28-2.7 40.9-6.9 2.3-.7 4.7-1.1 7.1-1.1 42.9 0 79.7 24.4 98.5 59.8C359.3 421.4 306.7 448 248 448z"></path></svg></i>About</a></li><li class="nav-item"><a class="nav-link" data-nav-identifier="research" href="/#research"><i><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="atom" class="svg-inline--fa fa-atom fa-w-14 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="margin-right:5px"><path fill="currentColor" d="M413.03 256c40.13-54.89 41.51-98.62 25.14-128-10.91-19.52-40.54-50.73-116.33-41.88C300.36 34.89 267.64 0 224 0s-76.36 34.89-97.84 86.12C50.43 77.34 20.73 108.48 9.83 128c-16.38 29.4-15 73.09 25.14 128-40.13 54.89-41.51 98.62-25.14 128 29.21 52.34 101.68 43.58 116.33 41.88C147.63 477.1 180.36 512 224 512s76.37-34.9 97.84-86.12c14.64 1.7 87.11 10.46 116.33-41.88 16.38-29.4 15-73.09-25.14-128zM63.38 352c-4.03-7.21-.19-24.8 14.95-48.29 6.96 6.53 14.2 12.89 21.87 19.18 1.71 13.71 4 27.08 6.76 40.08-24.56.89-39.89-4.37-43.58-10.97zm36.82-162.88c-7.66 6.29-14.9 12.65-21.87 19.18-15.13-23.5-18.97-41.09-14.95-48.3 3.41-6.14 16.39-11.47 37.92-11.47 1.71 0 3.87.3 5.69.37a472.191 472.191 0 0 0-6.79 40.22zM224 64c9.47 0 22.2 13.52 33.86 37.26-11.19 3.7-22.44 8-33.86 12.86-11.42-4.86-22.67-9.16-33.86-12.86C201.8 77.52 214.53 64 224 64zm0 384c-9.47 0-22.2-13.52-33.86-37.26 11.19-3.7 22.44-8 33.86-12.86 11.42 4.86 22.67 9.16 33.86 12.86C246.2 434.48 233.47 448 224 448zm62.5-157.33c-26.7 19.08-46.14 29.33-62.5 37.48-16.35-8.14-35.8-18.41-62.5-37.48-1.99-27.79-1.99-41.54 0-69.33 26.67-19.05 46.13-29.32 62.5-37.48 16.39 8.17 35.86 18.44 62.5 37.48 1.98 27.78 1.99 41.53 0 69.33zM384.62 352c-3.67 6.62-19 11.82-43.58 10.95 2.76-13 5.05-26.37 6.76-40.06 7.66-6.29 14.9-12.65 21.87-19.18 15.13 23.49 18.97 41.08 14.95 48.29zm-14.95-143.71c-6.96-6.53-14.2-12.89-21.87-19.18a473.535 473.535 0 0 0-6.79-40.22c1.82-.07 3.97-.37 5.69-.37 21.52 0 34.51 5.34 37.92 11.47 4.02 7.22.18 24.81-14.95 48.3zM224 224c-17.67 0-32 14.33-32 32s14.33 32 32 32 32-14.33 32-32-14.33-32-32-32z"></path></svg></i>Research</a></li><li class="nav-item"><a class="nav-link" data-nav-identifier="cv" href="/files/cv-yao.pdf">CV</a></li></ul></div></nav></div></header><div class="mb-4 container page-content" id="content"><main><div class="post-content"><article class="post" itemscope="" itemType="http://schema.org/Article"><header class="post-header"><h1>Key Concepts of C++</h1><div class="post-meta"><span><i><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="calendar" class="svg-inline--fa fa-calendar fa-w-14 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M400 64h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48zm-6 400H54c-3.3 0-6-2.7-6-6V160h352v298c0 3.3-2.7 6-6 6z"></path></svg></i>Posted on <!-- -->2019-09-14</span></div></header><div class="post-body"><h2 id="references-and-pointers">References and Pointers</h2>
<h3 id="what-are-the-differences-between-references-and-pointers">1. What are the differences between references and pointers?</h3>
<p>{% fold Answer %}</p>
<ol type="1">
<li><p>A reference must be initialized when declared. No restriction on pointers.</p></li>
<li><p>A reference cannot be changed to reference another object. Pointers can do that.</p></li>
<li><p>A reference cannot be NULL. Pointers can.</p></li>
</ol>
<p>Generally speaking, <strong>reference is safer, while pointer is more flexible</strong>.</p>
<p>{% endfold %}</p>
<h3 id="what-are-the-similarities-of-references-and-pointers">2 What are the similarities of references and pointers?</h3>
<p>{% fold Answer %}</p>
<ol type="1">
<li><p>They can be used to save the copying of large objects when passed to functions or return from functions.</p></li>
<li><p>They can be used to modify the variables passing in this function.</p></li>
</ol>
<p>{% endfold %}</p>
<hr />
<h2 id="polymorphism-多态-and-virtual-functions">Polymorphism (多态) and Virtual Functions</h2>
<p>Tutorial: <a href="http://www.cplusplus.com/doc/tutorial/polymorphism/">http://www.cplusplus.com/doc/tutorial/polymorphism/</a></p>
<h3 id="a.-what-are-virtual-functions">0a. What are virtual functions?</h3>
<p>http://www.geeksforgeeks.org/virtual-function-cpp/</p>
<ol type="1">
<li><p>Functions that are declared with a <code>virtual</code> keyword in <strong>base</strong> class. (这意味着，继承base的子类中对应的函数也是虚函数，但是virtual可以省略)</p></li>
<li><p>Mainly used to achieve Runtime Polymorphism（运行时多态，见下）.</p></li>
<li><p>Ensure the correct function is called for an object, regardless of the type of reference (or pointer). (C++里提供了这样的保证机制，见问题3)</p></li>
</ol>
<h3 id="b.-virtual-function的一些rule-号代表建议-思考为什么有这些限制">0b. Virtual function的一些Rule, *号代表建议 （思考为什么有这些限制！）：</h3>
<ol type="1">
<li><p>Virtual functions <strong>cannot</strong> be static and also <strong>cannot</strong> be a friend function of another class. Why? {% fold Answer %} Because it doesn't make any sense in C++.</p>
<p>Virtual functions are invoked when you have a pointer/reference to an instance of a class. Static functions aren't tied to a particular instance, they're tied to a class. C++ doesn't have pointers-to-class, so there is no scenario in which you could invoke a static function virtually.</p>
<p><a href="ttps://stackoverflow.com/questions/9863007/can-we-have-a-static-virtual-functions-if-not-then-why">https://stackoverflow.com/questions/9863007/can-we-have-a-static-virtual-functions-if-not-then-why</a> {% endfold %}</p></li>
<li><p>*Virtual functions should be accessed using pointer or reference of <strong>base class type</strong> to achieve run time polymorphism. Why?</p></li>
<li><p>*The prototype of virtual functions should be the same in the base and derived class. Why? {% fold Answer %} Because it will result in confusion. See this <a href="http://www.geeksforgeeks.org/output-of-c-program-set-12-2/">example</a>.</p>
<p>If the base virtual function uses default argument values, the derived virtual function should also include the default argument values in the code. This is not required by the compiler, but it's recommended. {% endfold %}</p></li>
<li><p>They are always defined in base class and overridden in derived class. It is not mandatory for derived class to override (or re-define the virtual function), in that case base class version of function is used.</p></li>
<li><p>A class may have virtual destructor but it <strong>cannot</strong> have a virtual constructor. Why? (Important question!) {% fold Answer %}</p>
<ol type="1">
<li><p>Virtual destructor See the example <a href="http://www.geeksforgeeks.org/virtual-destructor/">here</a>.</p>
<p>There are 2 issues if we don't have virtual destructor.</p>
<p>First, it will result in undefined behavior when <code>delete</code> using the base type pointer. Depending on the compiler, it might call the derived class destructor or the base class destructor.</p>
<p>Second, when the derived class dynamically allocates memory (using <code>new</code>), a normal destructor (without virtual) might not free the memory allocated and there will be memory leakage.</p></li>
<li><p>No virtual constructor Because there is no need of virtual constructor in C++. This is because C++ is static-typed language, meaning that, during compilation, the compiler needs to know the type to create an object. {% endfold %}</p></li>
</ol></li>
<li><p>*Don't write private virtual functions. Why? {% fold Answer %} This is because private virtual member functions can be overridden by derived class, which is very confusing. Normal private member functions cannot be overridden in derived class. <a href="https://stackoverflow.com/questions/9863007/can-we-have-a-static-virtual-functions-if-not-then-why">https://stackoverflow.com/questions/9863007/can-we-have-a-static-virtual-functions-if-not-then-why</a> {% endfold %}</p></li>
</ol>
<h3 id="c.-what-is-pure-virtual-function-what-is-abstract-class-why-we-need-abstract-class">0c. What is pure virtual function, What is abstract class? Why we need abstract class?</h3>
<p>{% fold Answer %} <a href="http://en.cppreference.com/w/cpp/language/abstract_class">http://en.cppreference.com/w/cpp/language/abstract_class</a></p>
<p>Pure virtual functions have the form:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">virtual</span> <span class="dt">int</span> f() = <span class="dv">0</span>;</a></code></pre></div>
<p>The <code>= 0</code> here is called pure-specifier. This means the function is not defined here.</p>
<p>An abstract class is a class that cannot be instantiated (You cannot create an object of an abstract class). So, if you have <strong>any</strong> pure virtual function in a class, then it is abstract.</p>
<p>Abstract class can be used to represent general concepts. For example, Shape is a general concepts, then we have Circle, Rectangle inherit the Shape. {% endfold %}</p>
<h3 id="what-is-polymorphism-in-c">1. What is polymorphism in C++?</h3>
<p>C++ polymorphism means that a call to a member function will cause a different function to be executed depending on the type of object that invokes the function. 简单的理解，就是“多种形态”。当一个Base类型的指针（这个指针可以指向继承了Base类型的object）call一个虚成员函数的时候，程序会自动根据这个指针指向的具体是什么类型，来运行对应的虚成员函数。可以看看下面这个例子。 （虚函数）</p>
<h3 id="example-see-what-is-happening-if-we-dont-use-virtual-functions.">2. Example: See what is happening if we don’t use virtual functions.</h3>
<p>—————Without virtual function—————</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">class</span> Shape {</a>
<a class="sourceLine" id="cb2-2" title="2">   <span class="kw">protected</span>:</a>
<a class="sourceLine" id="cb2-3" title="3">      <span class="dt">int</span> width, height;</a>
<a class="sourceLine" id="cb2-4" title="4">   <span class="kw">public</span>:</a>
<a class="sourceLine" id="cb2-5" title="5">      Shape( <span class="dt">int</span> a = <span class="dv">0</span>, <span class="dt">int</span> b = <span class="dv">0</span>): width(a), height(b) { }</a>
<a class="sourceLine" id="cb2-6" title="6">      <span class="dt">int</span> area() {</a>
<a class="sourceLine" id="cb2-7" title="7">         cout &lt;&lt; <span class="st">&quot;Parent class area:&quot;</span> &lt;&lt;endl;</a>
<a class="sourceLine" id="cb2-8" title="8">         <span class="cf">return</span> <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb2-9" title="9">      }</a>
<a class="sourceLine" id="cb2-10" title="10">};</a>
<a class="sourceLine" id="cb2-11" title="11"><span class="kw">class</span> Rectangle: <span class="kw">public</span> Shape {</a>
<a class="sourceLine" id="cb2-12" title="12">   <span class="kw">public</span>:</a>
<a class="sourceLine" id="cb2-13" title="13">      Rectangle( <span class="dt">int</span> a = <span class="dv">0</span>, <span class="dt">int</span> b = <span class="dv">0</span>):Shape(a, b) { }</a>
<a class="sourceLine" id="cb2-14" title="14">      <span class="dt">int</span> area () { </a>
<a class="sourceLine" id="cb2-15" title="15">         <span class="dt">int</span> _area = width * height;</a>
<a class="sourceLine" id="cb2-16" title="16">         cout &lt;&lt; <span class="st">&quot;Rectangle class area: &quot;</span> &lt;&lt; _area&lt;&lt;endl;</a>
<a class="sourceLine" id="cb2-17" title="17">         <span class="cf">return</span> area; </a>
<a class="sourceLine" id="cb2-18" title="18">      }</a>
<a class="sourceLine" id="cb2-19" title="19">};</a>
<a class="sourceLine" id="cb2-20" title="20"></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="dt">int</span> main() {</a>
<a class="sourceLine" id="cb2-22" title="22">   Shape *shape;</a>
<a class="sourceLine" id="cb2-23" title="23">   Rectangle rec(<span class="dv">10</span>,<span class="dv">7</span>);</a>
<a class="sourceLine" id="cb2-24" title="24"></a>
<a class="sourceLine" id="cb2-25" title="25">   <span class="co">// store the address of Rectangle</span></a>
<a class="sourceLine" id="cb2-26" title="26">   shape = &amp;rec;</a>
<a class="sourceLine" id="cb2-27" title="27">   </a>
<a class="sourceLine" id="cb2-28" title="28">   <span class="co">// call rectangle area.</span></a>
<a class="sourceLine" id="cb2-29" title="29">   shape-&gt;area();</a>
<a class="sourceLine" id="cb2-30" title="30">   <span class="cf">return</span> <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb2-31" title="31">}</a></code></pre></div>
<p>Result:</p>
<pre><code>Parent class area:</code></pre>
<p>—————With virtual function—————</p>
<p>(我们只修改 class “Shape” 的area function)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode cpp"><code class="sourceCode cpp"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">class</span> Shape {</a>
<a class="sourceLine" id="cb4-2" title="2">   <span class="kw">protected</span>:</a>
<a class="sourceLine" id="cb4-3" title="3">      <span class="dt">int</span> width, height;</a>
<a class="sourceLine" id="cb4-4" title="4">   <span class="kw">public</span>:</a>
<a class="sourceLine" id="cb4-5" title="5">      Shape( <span class="dt">int</span> a = <span class="dv">0</span>, <span class="dt">int</span> b = <span class="dv">0</span>): width(a), height(b) { }</a>
<a class="sourceLine" id="cb4-6" title="6">      <span class="kw">virtual</span> <span class="dt">int</span> area() {</a>
<a class="sourceLine" id="cb4-7" title="7">         cout &lt;&lt; <span class="st">&quot;Parent class area :&quot;</span> &lt;&lt;endl;</a>
<a class="sourceLine" id="cb4-8" title="8">         <span class="cf">return</span> <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb4-9" title="9">      }</a>
<a class="sourceLine" id="cb4-10" title="10">};</a></code></pre></div>
<p>Result:</p>
<pre><code>Rectangle class area: 70</code></pre>
<h3 id="what-is-the-mechanisms-that-c-uses-to-enable-polymorphism">3. What is the mechanisms that C++ uses to enable polymorphism?</h3>
<p>{% fold Answers %}</p>
<p>C++ mainly uses <strong>VPTR</strong> (virtual pointer) and <strong>VTABLE</strong> (virtual table) to do that.</p>
<!-- `VPTR` is maintained per object, while `VTABLE` is maintained per class. -->
<p>During compilation, if a class has virtual function(s), the compiler will add additional code to do the following things:</p>
<ol type="1">
<li><p>Create a static array of function pointers called <code>VTABLE</code>. 只要一个class有虚函数（无论是基类，还是子类），那么编译器会在这个class里加一个static的array，这个array里存的是这个class里所有虚函数的指针。</p></li>
<li><p>In the constructor of the class, add a data member <code>VPTR</code> to the object being created. the <code>VPTR</code> is a pointer pointing to <code>VTABLE</code> of the class.</p></li>
<li><p>In each polymophic function call(调用虚函数), first look for <code>VPTR</code> using the <strong>base class</strong> reference or pointer（每个object都有这个VPTR的成员变量, then we can access the vtable of the right class and call the right function.</p></li>
</ol>
<p>参考下面这个图:</p>
<figure>
<img src="C++/virtual-functions.png" alt="Illustration of VPTR and VTABLE" /><figcaption>Illustration of VPTR and VTABLE</figcaption>
</figure>
<p>{% endfold %}</p>
<h3 id="what-is-static-polymorphism-and-dynamicruntime-polymorphism">4. What is static polymorphism and dynamic(runtime) polymorphism？</h3>
<p>在C++中，static polymorphism指的是编译时的“多态”，包括templates（模版函数／模版类）和function overloading(函数重载). 在C++里面，我们一般就直说templates和function了，这个static polymorphism的术语用的比较少。 Dynamic Polymorphism就是前面提到的polymorphism。一般来说，不加说明的话，在C++里面，单说polymorphism就是指的通过虚函数实现的运行时(Runtime)多态</p>
<h3 id="sample-questions">Sample Questions:</h3>
<ol type="1">
<li>Can static</li>
</ol>
</div></article><hr/><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li></li><li></li></ul></div></main></div><footer id="m-footer" class="bg-light py-2 d-print-none"><div class="container"><div class="row"><div class="col-auto mx-auto mr-sm-0 py-2"><ul class="socials" style="text-align:right"><li><a href="/#"><i><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" style="font-size:13px"><path fill="currentColor" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V400c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5 0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"></path></svg></i></a></li><li><a href="https://github.com/myaooo"><i><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" style="font-size:13px"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></i></a></li><li><a href="https://scholar.google.com/citations?user=Fh0cwXUAAAAJ&amp;hl=en"><i><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="graduation-cap" class="svg-inline--fa fa-graduation-cap fa-w-20 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" style="font-size:13px"><path fill="currentColor" d="M622.34 153.2L343.4 67.5c-15.2-4.67-31.6-4.67-46.79 0L17.66 153.2c-23.54 7.23-23.54 38.36 0 45.59l48.63 14.94c-10.67 13.19-17.23 29.28-17.88 46.9C38.78 266.15 32 276.11 32 288c0 10.78 5.68 19.85 13.86 25.65L20.33 428.53C18.11 438.52 25.71 448 35.94 448h56.11c10.24 0 17.84-9.48 15.62-19.47L82.14 313.65C90.32 307.85 96 298.78 96 288c0-11.57-6.47-21.25-15.66-26.87.76-15.02 8.44-28.3 20.69-36.72L296.6 284.5c9.06 2.78 26.44 6.25 46.79 0l278.95-85.7c23.55-7.24 23.55-38.36 0-45.6zM352.79 315.09c-28.53 8.76-52.84 3.92-65.59 0l-145.02-44.55L128 384c0 35.35 85.96 64 192 64s192-28.65 192-64l-14.18-113.47-145.03 44.56z"></path></svg></i></a></li><li><a href="https://www.linkedin.com/in/yao-ming/"><i><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin fa-w-14 " role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" style="font-size:13px"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></i></a></li></ul></div><div class="col-auto copyright mx-auto ml-sm-0 py-2 order-sm-first">Copyright ©<span itemProp="copyrightYear"> <!-- -->2015 - 2019<!-- --> </span><span class="author" itemProp="copyrightHolder">Yao Ming<!-- -->. </span><span> All Rights Reserved.</span></div></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"dataManager":"[]","props":{"pageProps":{"page":{"frontmatter":{"title":"Key Concepts of C++"},"html":"\u003ch2 id=\"references-and-pointers\"\u003eReferences and Pointers\u003c/h2\u003e\n\u003ch3 id=\"what-are-the-differences-between-references-and-pointers\"\u003e1. What are the differences between references and pointers?\u003c/h3\u003e\n\u003cp\u003e{% fold Answer %}\u003c/p\u003e\n\u003col type=\"1\"\u003e\n\u003cli\u003e\u003cp\u003eA reference must be initialized when declared. No restriction on pointers.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eA reference cannot be changed to reference another object. Pointers can do that.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eA reference cannot be NULL. Pointers can.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003eGenerally speaking, \u003cstrong\u003ereference is safer, while pointer is more flexible\u003c/strong\u003e.\u003c/p\u003e\n\u003cp\u003e{% endfold %}\u003c/p\u003e\n\u003ch3 id=\"what-are-the-similarities-of-references-and-pointers\"\u003e2 What are the similarities of references and pointers?\u003c/h3\u003e\n\u003cp\u003e{% fold Answer %}\u003c/p\u003e\n\u003col type=\"1\"\u003e\n\u003cli\u003e\u003cp\u003eThey can be used to save the copying of large objects when passed to functions or return from functions.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThey can be used to modify the variables passing in this function.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e{% endfold %}\u003c/p\u003e\n\u003chr /\u003e\n\u003ch2 id=\"polymorphism-多态-and-virtual-functions\"\u003ePolymorphism (多态) and Virtual Functions\u003c/h2\u003e\n\u003cp\u003eTutorial: \u003ca href=\"http://www.cplusplus.com/doc/tutorial/polymorphism/\"\u003ehttp://www.cplusplus.com/doc/tutorial/polymorphism/\u003c/a\u003e\u003c/p\u003e\n\u003ch3 id=\"a.-what-are-virtual-functions\"\u003e0a. What are virtual functions?\u003c/h3\u003e\n\u003cp\u003ehttp://www.geeksforgeeks.org/virtual-function-cpp/\u003c/p\u003e\n\u003col type=\"1\"\u003e\n\u003cli\u003e\u003cp\u003eFunctions that are declared with a \u003ccode\u003evirtual\u003c/code\u003e keyword in \u003cstrong\u003ebase\u003c/strong\u003e class. (这意味着，继承base的子类中对应的函数也是虚函数，但是virtual可以省略)\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eMainly used to achieve Runtime Polymorphism（运行时多态，见下）.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eEnsure the correct function is called for an object, regardless of the type of reference (or pointer). (C++里提供了这样的保证机制，见问题3)\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"b.-virtual-function的一些rule-号代表建议-思考为什么有这些限制\"\u003e0b. Virtual function的一些Rule, *号代表建议 （思考为什么有这些限制！）：\u003c/h3\u003e\n\u003col type=\"1\"\u003e\n\u003cli\u003e\u003cp\u003eVirtual functions \u003cstrong\u003ecannot\u003c/strong\u003e be static and also \u003cstrong\u003ecannot\u003c/strong\u003e be a friend function of another class. Why? {% fold Answer %} Because it doesn't make any sense in C++.\u003c/p\u003e\n\u003cp\u003eVirtual functions are invoked when you have a pointer/reference to an instance of a class. Static functions aren't tied to a particular instance, they're tied to a class. C++ doesn't have pointers-to-class, so there is no scenario in which you could invoke a static function virtually.\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"ttps://stackoverflow.com/questions/9863007/can-we-have-a-static-virtual-functions-if-not-then-why\"\u003ehttps://stackoverflow.com/questions/9863007/can-we-have-a-static-virtual-functions-if-not-then-why\u003c/a\u003e {% endfold %}\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e*Virtual functions should be accessed using pointer or reference of \u003cstrong\u003ebase class type\u003c/strong\u003e to achieve run time polymorphism. Why?\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e*The prototype of virtual functions should be the same in the base and derived class. Why? {% fold Answer %} Because it will result in confusion. See this \u003ca href=\"http://www.geeksforgeeks.org/output-of-c-program-set-12-2/\"\u003eexample\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eIf the base virtual function uses default argument values, the derived virtual function should also include the default argument values in the code. This is not required by the compiler, but it's recommended. {% endfold %}\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eThey are always defined in base class and overridden in derived class. It is not mandatory for derived class to override (or re-define the virtual function), in that case base class version of function is used.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eA class may have virtual destructor but it \u003cstrong\u003ecannot\u003c/strong\u003e have a virtual constructor. Why? (Important question!) {% fold Answer %}\u003c/p\u003e\n\u003col type=\"1\"\u003e\n\u003cli\u003e\u003cp\u003eVirtual destructor See the example \u003ca href=\"http://www.geeksforgeeks.org/virtual-destructor/\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThere are 2 issues if we don't have virtual destructor.\u003c/p\u003e\n\u003cp\u003eFirst, it will result in undefined behavior when \u003ccode\u003edelete\u003c/code\u003e using the base type pointer. Depending on the compiler, it might call the derived class destructor or the base class destructor.\u003c/p\u003e\n\u003cp\u003eSecond, when the derived class dynamically allocates memory (using \u003ccode\u003enew\u003c/code\u003e), a normal destructor (without virtual) might not free the memory allocated and there will be memory leakage.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eNo virtual constructor Because there is no need of virtual constructor in C++. This is because C++ is static-typed language, meaning that, during compilation, the compiler needs to know the type to create an object. {% endfold %}\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003e*Don't write private virtual functions. Why? {% fold Answer %} This is because private virtual member functions can be overridden by derived class, which is very confusing. Normal private member functions cannot be overridden in derived class. \u003ca href=\"https://stackoverflow.com/questions/9863007/can-we-have-a-static-virtual-functions-if-not-then-why\"\u003ehttps://stackoverflow.com/questions/9863007/can-we-have-a-static-virtual-functions-if-not-then-why\u003c/a\u003e {% endfold %}\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch3 id=\"c.-what-is-pure-virtual-function-what-is-abstract-class-why-we-need-abstract-class\"\u003e0c. What is pure virtual function, What is abstract class? Why we need abstract class?\u003c/h3\u003e\n\u003cp\u003e{% fold Answer %} \u003ca href=\"http://en.cppreference.com/w/cpp/language/abstract_class\"\u003ehttp://en.cppreference.com/w/cpp/language/abstract_class\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003ePure virtual functions have the form:\u003c/p\u003e\n\u003cdiv class=\"sourceCode\" id=\"cb1\"\u003e\u003cpre class=\"sourceCode cpp\"\u003e\u003ccode class=\"sourceCode cpp\"\u003e\u003ca class=\"sourceLine\" id=\"cb1-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003evirtual\u003c/span\u003e \u003cspan class=\"dt\"\u003eint\u003c/span\u003e f() = \u003cspan class=\"dv\"\u003e0\u003c/span\u003e;\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe \u003ccode\u003e= 0\u003c/code\u003e here is called pure-specifier. This means the function is not defined here.\u003c/p\u003e\n\u003cp\u003eAn abstract class is a class that cannot be instantiated (You cannot create an object of an abstract class). So, if you have \u003cstrong\u003eany\u003c/strong\u003e pure virtual function in a class, then it is abstract.\u003c/p\u003e\n\u003cp\u003eAbstract class can be used to represent general concepts. For example, Shape is a general concepts, then we have Circle, Rectangle inherit the Shape. {% endfold %}\u003c/p\u003e\n\u003ch3 id=\"what-is-polymorphism-in-c\"\u003e1. What is polymorphism in C++?\u003c/h3\u003e\n\u003cp\u003eC++ polymorphism means that a call to a member function will cause a different function to be executed depending on the type of object that invokes the function. 简单的理解，就是“多种形态”。当一个Base类型的指针（这个指针可以指向继承了Base类型的object）call一个虚成员函数的时候，程序会自动根据这个指针指向的具体是什么类型，来运行对应的虚成员函数。可以看看下面这个例子。 （虚函数）\u003c/p\u003e\n\u003ch3 id=\"example-see-what-is-happening-if-we-dont-use-virtual-functions.\"\u003e2. Example: See what is happening if we don’t use virtual functions.\u003c/h3\u003e\n\u003cp\u003e—————Without virtual function—————\u003c/p\u003e\n\u003cdiv class=\"sourceCode\" id=\"cb2\"\u003e\u003cpre class=\"sourceCode cpp\"\u003e\u003ccode class=\"sourceCode cpp\"\u003e\u003ca class=\"sourceLine\" id=\"cb2-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003eclass\u003c/span\u003e Shape {\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-2\" title=\"2\"\u003e   \u003cspan class=\"kw\"\u003eprotected\u003c/span\u003e:\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-3\" title=\"3\"\u003e      \u003cspan class=\"dt\"\u003eint\u003c/span\u003e width, height;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-4\" title=\"4\"\u003e   \u003cspan class=\"kw\"\u003epublic\u003c/span\u003e:\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-5\" title=\"5\"\u003e      Shape( \u003cspan class=\"dt\"\u003eint\u003c/span\u003e a = \u003cspan class=\"dv\"\u003e0\u003c/span\u003e, \u003cspan class=\"dt\"\u003eint\u003c/span\u003e b = \u003cspan class=\"dv\"\u003e0\u003c/span\u003e): width(a), height(b) { }\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-6\" title=\"6\"\u003e      \u003cspan class=\"dt\"\u003eint\u003c/span\u003e area() {\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-7\" title=\"7\"\u003e         cout \u0026lt;\u0026lt; \u003cspan class=\"st\"\u003e\u0026quot;Parent class area:\u0026quot;\u003c/span\u003e \u0026lt;\u0026lt;endl;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-8\" title=\"8\"\u003e         \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"dv\"\u003e0\u003c/span\u003e;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-9\" title=\"9\"\u003e      }\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-10\" title=\"10\"\u003e};\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-11\" title=\"11\"\u003e\u003cspan class=\"kw\"\u003eclass\u003c/span\u003e Rectangle: \u003cspan class=\"kw\"\u003epublic\u003c/span\u003e Shape {\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-12\" title=\"12\"\u003e   \u003cspan class=\"kw\"\u003epublic\u003c/span\u003e:\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-13\" title=\"13\"\u003e      Rectangle( \u003cspan class=\"dt\"\u003eint\u003c/span\u003e a = \u003cspan class=\"dv\"\u003e0\u003c/span\u003e, \u003cspan class=\"dt\"\u003eint\u003c/span\u003e b = \u003cspan class=\"dv\"\u003e0\u003c/span\u003e):Shape(a, b) { }\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-14\" title=\"14\"\u003e      \u003cspan class=\"dt\"\u003eint\u003c/span\u003e area () { \u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-15\" title=\"15\"\u003e         \u003cspan class=\"dt\"\u003eint\u003c/span\u003e _area = width * height;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-16\" title=\"16\"\u003e         cout \u0026lt;\u0026lt; \u003cspan class=\"st\"\u003e\u0026quot;Rectangle class area: \u0026quot;\u003c/span\u003e \u0026lt;\u0026lt; _area\u0026lt;\u0026lt;endl;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-17\" title=\"17\"\u003e         \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e area; \u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-18\" title=\"18\"\u003e      }\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-19\" title=\"19\"\u003e};\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-20\" title=\"20\"\u003e\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-21\" title=\"21\"\u003e\u003cspan class=\"dt\"\u003eint\u003c/span\u003e main() {\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-22\" title=\"22\"\u003e   Shape *shape;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-23\" title=\"23\"\u003e   Rectangle rec(\u003cspan class=\"dv\"\u003e10\u003c/span\u003e,\u003cspan class=\"dv\"\u003e7\u003c/span\u003e);\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-24\" title=\"24\"\u003e\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-25\" title=\"25\"\u003e   \u003cspan class=\"co\"\u003e// store the address of Rectangle\u003c/span\u003e\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-26\" title=\"26\"\u003e   shape = \u0026amp;rec;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-27\" title=\"27\"\u003e   \u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-28\" title=\"28\"\u003e   \u003cspan class=\"co\"\u003e// call rectangle area.\u003c/span\u003e\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-29\" title=\"29\"\u003e   shape-\u0026gt;area();\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-30\" title=\"30\"\u003e   \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"dv\"\u003e0\u003c/span\u003e;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb2-31\" title=\"31\"\u003e}\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eParent class area:\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e—————With virtual function—————\u003c/p\u003e\n\u003cp\u003e(我们只修改 class “Shape” 的area function)\u003c/p\u003e\n\u003cdiv class=\"sourceCode\" id=\"cb4\"\u003e\u003cpre class=\"sourceCode cpp\"\u003e\u003ccode class=\"sourceCode cpp\"\u003e\u003ca class=\"sourceLine\" id=\"cb4-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003eclass\u003c/span\u003e Shape {\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb4-2\" title=\"2\"\u003e   \u003cspan class=\"kw\"\u003eprotected\u003c/span\u003e:\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb4-3\" title=\"3\"\u003e      \u003cspan class=\"dt\"\u003eint\u003c/span\u003e width, height;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb4-4\" title=\"4\"\u003e   \u003cspan class=\"kw\"\u003epublic\u003c/span\u003e:\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb4-5\" title=\"5\"\u003e      Shape( \u003cspan class=\"dt\"\u003eint\u003c/span\u003e a = \u003cspan class=\"dv\"\u003e0\u003c/span\u003e, \u003cspan class=\"dt\"\u003eint\u003c/span\u003e b = \u003cspan class=\"dv\"\u003e0\u003c/span\u003e): width(a), height(b) { }\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb4-6\" title=\"6\"\u003e      \u003cspan class=\"kw\"\u003evirtual\u003c/span\u003e \u003cspan class=\"dt\"\u003eint\u003c/span\u003e area() {\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb4-7\" title=\"7\"\u003e         cout \u0026lt;\u0026lt; \u003cspan class=\"st\"\u003e\u0026quot;Parent class area :\u0026quot;\u003c/span\u003e \u0026lt;\u0026lt;endl;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb4-8\" title=\"8\"\u003e         \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"dv\"\u003e0\u003c/span\u003e;\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb4-9\" title=\"9\"\u003e      }\u003c/a\u003e\n\u003ca class=\"sourceLine\" id=\"cb4-10\" title=\"10\"\u003e};\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eResult:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eRectangle class area: 70\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"what-is-the-mechanisms-that-c-uses-to-enable-polymorphism\"\u003e3. What is the mechanisms that C++ uses to enable polymorphism?\u003c/h3\u003e\n\u003cp\u003e{% fold Answers %}\u003c/p\u003e\n\u003cp\u003eC++ mainly uses \u003cstrong\u003eVPTR\u003c/strong\u003e (virtual pointer) and \u003cstrong\u003eVTABLE\u003c/strong\u003e (virtual table) to do that.\u003c/p\u003e\n\u003c!-- `VPTR` is maintained per object, while `VTABLE` is maintained per class. --\u003e\n\u003cp\u003eDuring compilation, if a class has virtual function(s), the compiler will add additional code to do the following things:\u003c/p\u003e\n\u003col type=\"1\"\u003e\n\u003cli\u003e\u003cp\u003eCreate a static array of function pointers called \u003ccode\u003eVTABLE\u003c/code\u003e. 只要一个class有虚函数（无论是基类，还是子类），那么编译器会在这个class里加一个static的array，这个array里存的是这个class里所有虚函数的指针。\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIn the constructor of the class, add a data member \u003ccode\u003eVPTR\u003c/code\u003e to the object being created. the \u003ccode\u003eVPTR\u003c/code\u003e is a pointer pointing to \u003ccode\u003eVTABLE\u003c/code\u003e of the class.\u003c/p\u003e\u003c/li\u003e\n\u003cli\u003e\u003cp\u003eIn each polymophic function call(调用虚函数), first look for \u003ccode\u003eVPTR\u003c/code\u003e using the \u003cstrong\u003ebase class\u003c/strong\u003e reference or pointer（每个object都有这个VPTR的成员变量, then we can access the vtable of the right class and call the right function.\u003c/p\u003e\u003c/li\u003e\n\u003c/ol\u003e\n\u003cp\u003e参考下面这个图:\u003c/p\u003e\n\u003cfigure\u003e\n\u003cimg src=\"C++/virtual-functions.png\" alt=\"Illustration of VPTR and VTABLE\" /\u003e\u003cfigcaption\u003eIllustration of VPTR and VTABLE\u003c/figcaption\u003e\n\u003c/figure\u003e\n\u003cp\u003e{% endfold %}\u003c/p\u003e\n\u003ch3 id=\"what-is-static-polymorphism-and-dynamicruntime-polymorphism\"\u003e4. What is static polymorphism and dynamic(runtime) polymorphism？\u003c/h3\u003e\n\u003cp\u003e在C++中，static polymorphism指的是编译时的“多态”，包括templates（模版函数／模版类）和function overloading(函数重载). 在C++里面，我们一般就直说templates和function了，这个static polymorphism的术语用的比较少。 Dynamic Polymorphism就是前面提到的polymorphism。一般来说，不加说明的话，在C++里面，单说polymorphism就是指的通过虚函数实现的运行时(Runtime)多态\u003c/p\u003e\n\u003ch3 id=\"sample-questions\"\u003eSample Questions:\u003c/h3\u003e\n\u003col type=\"1\"\u003e\n\u003cli\u003eCan static\u003c/li\u003e\n\u003c/ol\u003e\n"},"asPath":"/notes/cpp/","userAgent":"server"}},"page":"/_page","query":{"fullUrl":"/notes/cpp/"},"buildId":"zrRi-1ffeFEQNXR69U2LU","dynamicBuildId":false,"nextExport":true}</script><script async="" id="__NEXT_PAGE__/_page" src="/_next/static/zrRi-1ffeFEQNXR69U2LU/pages/_page.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/_next/static/zrRi-1ffeFEQNXR69U2LU/pages/_app.js"></script><script src="/_next/static/runtime/webpack-8ed9452df514b4d17d80.js" async=""></script><script src="/_next/static/chunks/commons.e955fcbc742f6dbffcf8.js" async=""></script><script src="/_next/static/chunks/styles.a36c8329d462c9b58534.js" async=""></script><script src="/_next/static/runtime/main-fd73dbd6f398b7b886ec.js" async=""></script></body></html>